<%@ page contentType="text/html; charset=utf-8" pageEncoding="utf-8"%><%@ include file="../../common/taglibs.jsp" %>
<section id="contents">	<div class="contents_bx_type1">		<div class="contents_bx_inner">			<div id="path" class="fixed">				<div class="pathInner">					<h2>상품관리</h2>					<div class="btns_area">						<button class="btn_pack btn_mo d_gray" onclick="modProdItem('upd');"><img src="/common//admin/images/common/ico_save.png">수정</button>						<button class="btn_pack btn_mo d_gray" onclick="modProdItem('open');"><img src="/common/admin/images/common/ico_save.png">OPEN</button>													<a href="javascript: gotoUrl('/admin/product/prodlist.af'); " class="btn_pack btn_mo gray"><img src="/common//admin/images/common/ico_list.png">목록</a>					</div>				</div>			</div>			<div class="tb_type2">				<h3>기본정보</h3>				<select name="" id="cateSel" class="customized-select" onchange="selItemSubCode(this);">				    <option value="">선택</option>				<c:forEach items="${itemList}" var="items" varStatus="status">					<option value="${itemList[status.index].ITEM_CODE}">${itemList[status.index].ITEM_NM}</option>												</c:forEach>				</select>								<table>					<tbody>						<tr>							<th>카테고리</th>							<td id="strCateNm"><!-- 								<select name="" id="cateSel" class="customized-select" onchange="selItemSubCode(this);"> --><!-- 								    <option value="">선택</option> --><%-- 								<c:forEach items="${itemList}" var="items" varStatus="status"> --%><%-- 									<option value="${itemList[status.index].ITEM_CODE}">${itemList[status.index].ITEM_NM}</option>								 --%><%-- 								</c:forEach> --%><!-- 								</select> -->							</td>							<th>상품명</th>							<td><input type="text" name="" id="prodName" class="ipt2 w100p" value="" onkeyup="settingItem(this,'itemName');"></td>						</tr>						<tr>							<th>상태</th>							<td id="status">								<span class="status">${paramater.status}</span>							</td>							<th>URL</th>							<td><input type="text" name="" id="prodUrl" value="" class="ipt2 w100p" onkeyup="settingItem(this,'itemUrl');"></td>						</tr>						<tr class="option">							<th>기타옵션</th>							<td colspan="3">								<label>이벤트 장소 </label>								<select name="" id="optionSel" class="customized-select" onchange="settingItem(this,'itemOption');">									<option value="0">전체</option>								<c:forEach items="${ePlaceList}" var="place" varStatus="status">									<option value="${ePlaceList[status.index].ITEM_CODE}">${ePlaceList[status.index].ITEM_NM}</option>																</c:forEach>								</select>								<label>소인입장불가 <input type="checkbox" name="" id="child" value="" onchange="chkChild('childChk');"></label>							</td>						</tr>					</tbody>				</table>			</div>			<form id="itemSet" name="itemSet" method="post">			<input type="hidden" name="itemyear" id="itemyear" value="${paramater.year}"/>			<input type="hidden" name="itemmonth" id="itemmonth" value="${paramater.month}"/>			<input type="hidden" name="itemName" value=""/>			<input type="hidden" name="itemUrl" value=""/>			<input type="hidden" name="itemOption" value=""/>										<input type="hidden" name="childChk" value=""/>			<input type="hidden" name="mode" id="mode" value=""/>								<div class="tb_type1 mb20">				<h3>가격정보 설정</h3>				<table>					<colgroup>						<col width="15%" />						<col/>					</colgroup>					<tbody>						<tr>							<td>성수기 지정</td>							<td class="tit">								<select name="" id="" class="customized-select selectSeason">								<c:forEach items="${seasonList}" var="seasons" varStatus="status">									<option value="${seasonList[status.index].CODE_ID}">${seasonList[status.index].CODE_NM}</option>																</c:forEach>								</select>								<input type="" name="" class="ipt2 datepicker" id="startDay" value="${paramater.year}.${paramater.month}.01"/> ~ <input type="" name="" class="ipt2 datepicker" id="endDay" value="${paramater.year}.${paramater.month}.01"/> 							</td>						</tr>						<tr class="normal_season">							<td>평수기</th>							<td class="tit">								<label>대인가: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">원</span>								<label>소인가: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">원</span>								<label>지정수량: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">개</span>							</td>						</tr>						<tr class="halfpeak_season">							<td>준성수기</td>							<td class="tit">								<label>대인가: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">원</span>								<label>소인가: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">원</span>								<label>지정수량: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">개</span>							</td>						</tr>						<tr class="peak_season">							<td>성수기</td>							<td class="tit">								<label>대인가: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">원</span>								<label>소인가: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">원</span>								<label>지정수량: </label>								<input type="number" name="" class="ipt2 w140" placeholder="숫자만 입력하세요"/><span class="unitTxt">개</span>							</td>						</tr>						<tr>							<th colspan="2">								<div class="tb_btn_area">									<button class="btn_pack btn_mo white setPrice">적용</button>									<button class="btn_noborder blue_nb setReset">초기화</button>								</div>							</th>						</tr>					</tbody>				</table>			</div>			<div class="tb_type1 calendar">				<input type="hidden" name="" id="event_local">				<input type="hidden" name="" id="child_enter">				<table id="calendar" class="fc-calendar-container">					<thead>						<th colspan="8">							<strong><span id="custom-year">2016</span>년 <span id="custom-month">9</span>월</strong>						</th>					</thead>					<tbody class="dump">						<tr>							<th>								<div class="date"></div>								<div class="cate">									<ul class="list">										<li>대인가</li>										<li>소인가</li>										<li>지정수량</li>										<li class="season"></li>									</ul>								</div>							</th>							<td>								<div class="date">									<p>일 / 1</p>								</div>								<div class="prdItem">									<div class="cate item2">										<ul class="list">										    																					<li class="adult"><input type="number" name="pkAdultW" value="" class="ipt2 w100p"/></li>											<li class="child"><input type="number" name="pkChildW" value="" class="ipt2 w100p"/></li>											<li class="qty"><input type="number" name="pkQty" value="" class="ipt2 w100p"/></li>											<li class="season"></li>										    <input type="hidden" name="packageDate" value=""/>										    <input type="hidden" name="itemSeason" value="NORMAL"/>										    <input type="hidden" name="itemSubCode" value=""/>										    <input type="hidden" name="itemcode" value="${paramater.code}"/>										    <input type="hidden" name="itemStatus" value=""/>										    <input type="hidden" name="itemUid" value=""/>																						</ul>									</div>								</div>							</td>						</tr>					</tbody>				</table>			</div>			</form>		</div>	</div></section><script type="text/javascript">$( document ).ready(function(){	var nowYearMonth = '${paramater.year}${paramater.month}';	for(var i=1;i<=$(".item2").length;i++){		var day = "";		if(i<10){			day = "0"+i;		}else{			day = i;		}			var nowDay = nowYearMonth + day;		$("#"+nowDay).next().find("ul > input").eq(0).val(nowDay);	}		modItemSet();});function modItemSet(){		$.ajax({	    url: "/admin/product/ajaxModItems.af",	    type: "POST",	    dataType:"json",	    data: {"year":$("#year").val(),"month":$("#month").val(), "code":$("#code").val(), "subcode" : $("#subcode").val()},	    success: function(data) {	    		        $.each(data, function(key){	        	//var itemCode = data[key].ITEM_CODE;        		var itemSelector = $("#"+data[key].YYYYMMDD).next();        		itemSelector.find("input[name='pkAdultW']").val(data[key].ADULTS_PRICE);        		itemSelector.find("input[name='pkChildW']").val(data[key].CHILD_PRICE);        		itemSelector.find("input[name='pkQty']").val(data[key].QUANTITY);        		itemSelector.find("input[name='itemcode']").val(data[key].CATE_CODE);        		itemSelector.find("input[name='itemSubCode']").val(data[key].ITEM_CODE);        		itemSelector.find("input[name='itemStatus']").val(data[key].ITEM_STATUS);        		itemSelector.find("input[name='itemSeason']").val(data[key].SEASON_TYPE);        		itemSelector.find("input[name='itemUid']").val(data[key].SET_UID);        		        		var itemStatus = itemSelector.find("input[name='itemStatus']").val();        		var itemSeason = itemSelector.find("input[name='itemSeason']").val();        		if(itemStatus == 'OPEN'){        			itemSelector.find("input[name='pkAdultW']").attr("readonly", true);        			itemSelector.find("input[name='pkChildW']").attr("readonly", true);        			//itemSelector.find("input[name='pkQty']").attr("readonly", true);        			        			if(itemSeason == 'PEAK'){	        			itemSelector.find('.season').addClass('on');	        			itemSelector.find('.season').html('');	        			itemSelector.find('.season').html('<span class="season_txt peak">성수기</span>');        			}else if(itemSeason == 'NONPEAK'){	        			itemSelector.find('.season').addClass('on');	        			itemSelector.find('.season').html('');	        			itemSelector.find('.season').html('<span class="season_txt halfpeak">준성수기</span>');	        				        			}        			        		}else if(itemStatus == 'CLOSE'){        			        			if(itemSeason == 'PEAK'){	        			itemSelector.find('.season').addClass('on');	        			itemSelector.find('.season').html('');	        			itemSelector.find('.season').html('<span class="season_txt peak">성수기</span><span class="season_close">X</span>');        			}else if(itemSeason == 'NONPEAK'){	        			itemSelector.find('.season').addClass('on');	        			itemSelector.find('.season').html('');	        			itemSelector.find('.season').html('<span class="season_txt halfpeak">준성수기</span><span class="season_close">X</span>');	        				        			}        			        		}        			        			        });	           	        //$("#cateSel > option[value='"+data[0].ITEM_CODE+"']").attr("selected","selected");	        //$("#cateSel > option[value='"+data[0].ITEM_CODE+"']").change();	        $("#strCateNm").text(data[0].ITEM_NAME);	        	        $("#optionSel > option[value='"+data[0].ITEM_OPTION+"']").attr("selected","selected");	        $("#optionSel > option[value='"+data[0].ITEM_OPTION+"']").change();	                	        $("#prodName").val(data[0].ITEM_NM);	        $("#prodUrl").val(data[0].ITEM_URL);	        	        $("input[name='itemName']").val(data[0].ITEM_NM);	        $("input[name='itemUrl']").val(data[0].ITEM_URL);	        $("input[name='itemOption']").val("");	        $("input[name='childChk']").val(data[0].CHILD_CHEK);	        	        if(data[0].CHILD_CHEK == 'Y'){	        	$("#child").attr("checked",true);	        }	        	        var allStatus = $("#status").find('span').text();	        if(allStatus == 'OPEN'){	        	$(".setPrice").hide();	        	$(".setReset").hide();	        	$(".btns_area > button").eq(0).hide();	        }	    },	});	};function modProdItem(param){	$("#mode").val(param);	$("#itemSet").attr('action','/admin/product/updProd_package.af');	$("#itemSet").submit();		};function selItemSubCode(obj){// 	var param = $(obj).val();// 	$(".item2").find("input[name='itemSubCode']").each(function(i, el) {// 		$(this).val(param);// 	}); 	var param = $(obj).val();    var url = "";    var html = ""; 	$("#subcode").val(param);			$.ajax({	    url: "/admin/product/ajaxItemCnt.af",	    type: "POST",	    dataType:"json",	    data: {"year":$("#year").val(),"month":$("#month").val(), "code":$("#code").val(), "subcode" : $("#subcode").val()},	    success: function(data) {			if(data == '0'){				url = '/admin/product/prod_package.af';				$("input[name='status']").val("EMPTY");			}else{				url = '/admin/product/modProd_package.af';			}					gotoUrl(url);	    }	});};function settingItem(obj,name){	var param = $(obj).val();	$("input[name='"+name+"']").val(param);};function chkChild(name){	var param = "N";	if($('#child').is(':checked'))param = "Y";	$("input[name='"+name+"']").val(param);};function gotoUrl(url){	$("#gotoUrl").attr('action',url);	$("#gotoUrl").submit();		}; </script><form name="gotoUrl" id="gotoUrl" method="post">	<input type="hidden" name="year" id="year" value="${paramater.year}"/>	<input type="hidden" name="month" id="month" value="${paramater.month}"/>	<input type="hidden" name="code" id="code" value="${paramater.code}"/>	<input type="hidden" name="status" value="${paramater.status}"/>	<input type="hidden" name="subcode" id="subcode" value="${paramater.subcode}"/>			</form>