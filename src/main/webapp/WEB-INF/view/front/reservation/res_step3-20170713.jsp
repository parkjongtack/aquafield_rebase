<%@ page contentType="text/html; charset=utf-8" pageEncoding="utf-8"%><%@ include file="../../common/taglibs.jsp" %><section id="res_step3">	 <header>	 	<h3><span>STEP 3 ##</span> 결제수단을 선택하세요.</h3>	 </header>	 <form id="KSPayWeb" name=KSPayWeb action = "" method="post">	 <input type="hidden" name="rsData" value='${rsData}'/>	 <input type="hidden" name="sndStoreid" value="${params.sndStoreid}"/>	 <input type="hidden" name="sndOrdernumber" value="${params.sndOrdernumber}"/>	 <input type="hidden" name="sndGoodname" value="${params.sndGoodname}"/>	 <input type="hidden" name="sndAmount" value="${params.sndAmount}"/>	 <input type="hidden" name="sndOrdername" value="${params.sndOrdername}"/>	 <input type="hidden" name="sndEmail" value="${params.sndEmail}"/>	 <input type="hidden" name="sndMobile" value="${params.sndMobile}"/>     <input type="hidden" name="sndServicePeriod"  value="${params.sndServicePeriod}~${params.sndServicePeriod}"/>	 <input type="hidden" name="reserveUid" value="${reserveUid}"/> 	 	<ul class="payment_list"><!--             <li class="ssg"> --><!--                 <a href="javascript:void(0);" onclick=""> --><!--                     <div class="tit"><img class="ico" src="/common/front/images/ico/ico_pay_ssg.png"/>SSGPAY 결제</div><input type="radio" name="sndPaymethod" value=""> --><!--                 </a> --><!--             </li> -->            <li class="ssg">                <div class="tit">                    <p class="chk_motion lst_check3">                        <label><img class="ico" src="/common/front/images/ico/ico_pay_ssg.png"/><input type="radio" name="sndPaymethod" value="1000000000"><span>SSGPAY 결제(서비스 준비중)</span><span class="bx_chk"></span></label>                    </p>                </div>            </li>            <li class="credit">                <div class="tit">                    <p class="chk_motion lst_check3">                        <label><img class="ico" src="/common/front/images/ico/ico_pay_credit.png"/><input type="radio" name="sndPaymethod" value="1000000000"><span>신용카드결제</span><span class="bx_chk"></span></label>                    </p>                </div>            </li>            <li class="bank">                <div class="tit">                    <p class="chk_motion lst_check3">                        <label><img class="ico" src="/common/front/images/ico/ico_pay_bank.png"/><input type="radio" name="sndPaymethod" value="0010000000"><span>실시간 계좌이체</span><span class="bx_chk"></span></label>						<span class="txt_alert" style="display:none;"></span>                    </p>                </div>            </li>        </ul>		<input type="hidden" name=sndSsgPay value="">		<input type="hidden"	name=sndReply value="">		<input type="hidden"  name=sndGoodType value="1">		<input type="hidden"  name=sndShowcard value="I,M">		<input type="hidden"	name=sndCurrencytype value="WON">		<input type="hidden"	name=sndInstallmenttype value="ALL(0:2:3:4:5:6:7:8:9:10:11:12)">		<input type="hidden"	name=sndInteresttype value="NONE">		<input type="hidden"	name=sndEscrow value="0">		<input type="hidden"	name=sndWptype value="1">		<input type="hidden"	name=sndAdulttype value="1">	    <input type="hidden"  name=sndCashReceipt value="1">		<input type="hidden"  name=sndMembId value="userid">		<input type="hidden" name=reWHCid 	value="">		<input type="hidden" name=reWHCtype 	value="">		<input type="hidden" name=reWHHash 	value="">		<div class="resRuleBoxArea">            <div class="resRuleBoxTitle">결제 전에 꼭 확인해주세요</div>            <div class="resRuleBox">                <div id="resRule" class="resRule">                    <strong>[이용규정]</strong>                    <ul>                        <li>이용일 전일 23시까지 결제를 완료하셔야 온라인 예약이 확정 됩니다.</li>                        <li>이용일 전일까지 예약하셔야 이용 가능합니다(당일 예약 및 이용불가). </li>                        <li>본인을 포함하여 최대 10명까지 예약 가능합니다.</li>                        <li>36개월 미만 유아는 무료입장이 가능하며, 입장 시 의료보험증 등의 증빙서류를 매표소에 제시 바랍니다.</li>                        <li>소인(36개월 ~ 초등학생) 입장 시 의료보험증 등의 증빙서류를 매표소에 제시 바랍니다.</li>                    </ul>                </div>            </div>            <div class="resRuleBox">                <div id="resRule" class="resRule">                    <strong>[환불규정]</strong>                    <ul>                        <li>이용일 당일 취소 및 이용일 경과 후 미사용 건은 결제액의 10%를 위약금으로 공제하여 환불해 드립니다.</li>                        <li>이용일 전 취소는 이용일 1일 전 23시까지 온라인에서 취소해 주시기 바랍니다.</li>                        <li>현장 이벤트 및 프로모션 등의 할인은 중복적용이 불가하며, 온라인 예약 전 반드시 홈페이지를 확인 바랍니다 (현장 이벤트 및 프로모션 등의 할인으로 인한 당일취소도 10% 위약금이 발생합니다).</li>                        <li>결제 완료 후 변경(인원, 일자 등)은 불가하므로 온라인에서 전체 취소 후 다시 예약해 주시기 바랍니다.</li>                        <li>온라인 예약의 변경 및 취소는 반드시 온라인에서만 가능합니다.(현장 변경 및 취소 불가)</li>                    </ul>                </div>            </div>        </div>	 </form>	 <footer class="btns center">       <%-- <button class="btn_pack btn_mo gray" onclick='reservationPop.addCont({url : "/reserve/step02.af",data : {prod : "${num}"}})'><img src="/common/front/images/ico/ico_arr_left2.gif" alt="<"> <span>이전으로</span></button> --%>       <button id="btn_pay_check" class="btn_pack btn_mo orange" onclick='javascript:_payChek(document.KSPayWeb);'><span>결제하기</span> <img src="/common/front/images/ico/ico_arr_right2.gif" alt=">"></button>	 </footer>     <script type="text/javascript">     	var ip = "";	     $(function() {	 		$.getJSON("https://api.ipify.org?format=jsonp&callback=?",	 			function(json) {	 				ip = json.ip;	 				console.log("###########:::"+ip);	 			}	 		);	 	});         setChkAndRadio();		(function(){			var shown = false;			var btnSubmit = $("#btn_pay_check");			if(ischrome && !isandroid){				$('input[name=sndPaymethod]').click(function(e){					if($(this).filter(function(){return this.value === '0010000000'}).prop('checked')){						if(!shown) $(".bank .txt_alert").text('PC 크롬브라우저에서는 실시간 계좌이체를 지원하지 않습니다.').show();						btnSubmit.addClass('gray3');						shown = true;					}else{						btnSubmit.removeClass('gray3');						if(shown) $(".bank .txt_alert").text('').hide();						shown = false;					}					return;				});			}		})();     	function _payChek(obj){			if(ischrome && !isandroid && $('.bank input[name=sndPaymethod]').prop('checked')) return; //피씨 크롬이며, 실시간 계좌이체일때는 결제 막기						if($('.ssg input[name=sndPaymethod]').prop('checked')){				if(ip == "115.94.37.77"){					$('input[name=sndSsgPay]').val('1');				}				else{					alert("SSGPAY 결제는 서비스 준비중입니다.");					return false;				}			}			var formData = $("#KSPayWeb").serialize();	    	$.ajax({		   		type: "post"		   		,url : '/reserve/payCheck.af'		   		,data : formData		   		,dataType : "html"		   		,success: function(data){		   			eval(data);		   		}		   		,error: function(xhr, option, error){		   			alert("에러가 발생했습니다. 잠시 후에 다시하세요.");		   		}	   		});     	};	 	function _pay(_frm)		{	 		  	 		  // 인증모듈 옵션	 		  //if ( (navigator.appName == 'Netscape') && (navigator.userAgent.toLowerCase().indexOf('trident') == -1) && $(':radio[name="sndPaymethod"]:checked').val() === '0010000000')	 		  //{					//alert('실시간 계좌이체는 Internet Explorer에서만 사용이 가능합니다.');					//return;	 		  //}else{					var agent = navigator.userAgent;					var midx		= agent.indexOf("MSIE");					var out_size	= (midx != -1 && agent.charAt(midx+5) < '7');					if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {						_frm.sndReply.value           = "https://" + location.host + "/reserve/mkspay.af";//getLocalUrl("/reserve/mkspay.af") ;						//모바일						_frm.action ='https://kspay.ksnet.to/store/mb2/KSPayPWeb_utf8.jsp';					}else{						//	20170704  KBR :  						//	실서버 환경						_frm.sndReply.value           = "https://" + location.host + "/reserve/kspayRcv.af";											// 개발서버 환경						//_frm.sndReply.value           = getLocalUrl("/reserve/kspayRcv.af") ;												//PC						var width_	= 500;						var height_	= out_size ? 568 : 518;						var left_	= screen.width;						var top_	= screen.height;						left_ = left_/2 - (width_/2);						top_ = top_/2 - (height_/2);						op = window.open('about:blank','AuthFrmUp',						        'height='+height_+',width='+width_+',status=yes,scrollbars=no,resizable=no,left='+left_+',top='+top_+'');						if (op == null)						{							alert("팝업이 차단되어 결제를 진행할 수 없습니다.");							return false;						}						_frm.target = 'AuthFrmUp';						_frm.action ='https://kspay.ksnet.to/store/KSPayFlashV1.3/KSPayPWeb.jsp?sndCharSet=utf-8';					}					_frm.submit();	 		  //}	    }		function getLocalUrl(mypage)		{			var myloc = location.href;			return myloc.substring(0, myloc.lastIndexOf('/')) + '/' + mypage;		}		function goResult(){			var formData = $("#KSPayWeb").serialize().replace(/%/g,'%25');						var mem_id = $("input[name=sndEmail]").val();									// 20170703 - KBR			// 개발서버 환경			//var url = "/reserve/payProccess_test.af";						// 실서버 환경			var url = "/reserve/payProccess.af";			//내부 접속일 경우, 테스트 로직을 태우도록			if(ip == "115.94.37.77"){				url = "/reserve/payProccess_test.af";				}				    	$.ajax({		   		type: "post"		   		,url : url		   		,data : formData		   		,dataType : "html"		   		,success: function(data){		   			eval(data);		   		}		   		,error: function(xhr, option, error){		   			alert("에러가 발생했습니다. 잠시 후에 다시하세요.");		   		}	   		});		}		function eparamSet(rcid, rctype, rhash){			document.KSPayWeb.reWHCid.value 	= rcid;			document.KSPayWeb.reWHCtype.value   = rctype  ;			document.KSPayWeb.reWHHash.value 	= rhash  ;		}		function gotoFinal(){			reservationPop.addCont({url : '/reserve/final.af', data : $("#KSPayWeb").serialize().replace(/%/g,'%25')});		}				function goResult2(){			console.log("rsData :: "+$("input[name=rsData]").val());						return false;			var formData = $("#KSPayWeb").serialize().replace(/%/g,'%25');	    	$.ajax({		   		type: "post"		   		,url : '/reserve/payProccessPCTest.af'		   		,data : formData		   		,dataType : "html"		   		,success: function(data){		   			eval(data);		   		}		   		,error: function(xhr, option, error){		   			alert("에러가 발생했습니다. 잠시 후에 다시하세요.");		   		}	   		});		}     </script></section>