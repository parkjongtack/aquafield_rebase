<%@ page contentType="text/html; charset=utf-8" pageEncoding="utf-8"%><%@ include file="../../common/taglibs.jsp" %><jsp:useBean id="now" class="java.util.Date" /><fmt:formatDate value="${now }" pattern="yyyyMMdd" var="today" /><fmt:parseDate value="${fn:replace(vo.RESERVE_DATE, '.', '')}" var="temp" pattern="yyyyMMdd" /><fmt:formatDate value="${temp}" pattern="yyyyMMdd" var="reserve_date1"/> <script type="text/javascript">	//상태 업데이트 ajax 	function updateAjax(){		var stat = $("select[name='reserve_state']").val();		var idx  = $("input[name='reserve_uid']").val();				$.ajax({			method: "POST",			url: "/secu_admaf/admin/reservation/res_update.af",			dataType: "JSON",			data : { reserve_state : stat, reserve_uid : idx, order_num : "${vo.ORDER_NUM }", order_nm : "${vo.ORDER_NM }" },			success:function(data){				if(data >= 1){					alert("수정을 완료 하였습니다.");										//완료 처리 됬으면 페이지 초기화하고 목록으로 이동					location.href= "/secu_admaf/admin/reservation/index.af"				}else{					alert("알 수 없는 오류가 발생하였습니다.");					return false;				}			},			error : function(xhr, status, error) {                 alert("알 수 없는 오류가 발생하였습니다.");                 return false;           }		})	}	</script><section id="contents">	<div class="contents_bx_type1">		<div class="contents_bx_inner">			<form name="serach_form" id="serach_form" action="/secu_admaf/admin/reservation/res_update.af" method="post" >				<input type="hidden" name="page" value="${resultParam.page }">				<input type="hidden" name="reserve_uid" value="${resultParam.reserve_uid }">			<div id="path" class="fixed">				<div class="pathInner">					<h2>예약내역</h2>					<div class="btns_area">						<c:if test="${vo.RESERVE_STATE eq 'ING'}">							<button class="btn_pack btn_mo d_gray" type="button" onclick="updateAjax();"><img src="/admaf/images/common/ico_save.png">저장</button>						</c:if>						<a href="/secu_admaf/admin/reservation/index.af" class="btn_pack btn_mo gray"><img src="/admaf/images/common/ico_list.png">목록</a>					</div>				</div>			</div>			<div class="tb_type2 mb20">				<h3>예약관리</h3>				<table>					<tbody>						<tr>							<th>예약번호</th>							<td>${vo.ORDER_NUM }</td>							<th>지점</th>							<td>${vo.POINT_NM }</td>						</tr>						<tr>							<th>방문일</th>							<td>								<%-- <input type="reserve_date" name="reserve_date" class="ipt2 datepicker" value="${vo.RESERVE_DATE }" /> --%>								${vo.RESERVE_DATE }							</td>							<th>상태</th>							<td>								${vo.RESERVE_STATE_NM }								<%-- <c:if test="${vo.RESERVE_STATE eq 'ING' }">예약</c:if>								<c:if test="${vo.RESERVE_STATE eq 'USE' }">이용완료</c:if>								<c:if test="${vo.RESERVE_STATE eq 'NOUSE' }">미사용</c:if>								<c:if test="${vo.RESERVE_STATE eq 'CANCEL' }">정상취소</c:if>								<c:if test="${vo.RESERVE_STATE eq 'FCANCEL' }">위약취소</c:if> --%><!-- 								<select name="reserve_state" id="reserve_state" class="customized-select"> --><%-- 									<c:forEach items="${codeRSRVT_TYPE }" var="code" > --%><%-- 										<option value="${code.CODE_ID }" <c:if test="${vo.RESERVE_STATE == code.CODE_ID }">selected="selected"</c:if> >${code.CODE_NM }</option> --%><%-- 									</c:forEach> --%><!-- 								</select> -->							</td>						</tr>						<tr>							<th>회원명</th>							<td>								<c:choose>									<c:when test="${MEMINFOYN eq 'Y'}">										${vo.MEM_NM }( ${vo.MEM_ID} )																			</c:when>									<c:otherwise>										${vo.MASK_MEM_NM }( ${vo.MASK_MEM_ID} )									</c:otherwise>								</c:choose>								</td>							<th>결제방법</th>							<td>${vo.PAYMENT_TYPE_NM }</td>						</tr>						<tr>							<th>총 방문인원</th>							<td>${vo.ADULT_SUM + vo.CHILD_SUM } 명</td>							<th>결제일</th>							<td>${vo.PAYMENT_DATE }</td>						</tr>						<tr>							<th>휴대폰번호</th>							<td>								<c:if test="${MEMINFOYN eq 'Y'}">							    <c:choose>							    <c:when test="${fn:length(vo.MEM_MOBILE) > 10 }">							    	${fn:substring(vo.MEM_MOBILE,0,3)}-${fn:substring(vo.MEM_MOBILE,3,7)}-${fn:substring(vo.MEM_MOBILE,7,11)}							    </c:when>							    <c:otherwise>							    	${fn:substring(vo.MEM_MOBILE,0,3)}-${fn:substring(vo.MEM_MOBILE,3,6)}-${fn:substring(vo.MEM_MOBILE,6,10)}							    </c:otherwise>							    							    </c:choose>								    </c:if>							    <c:if test="${MEMINFOYN eq 'N'}">							    	${vo.MASK_MEM_MOBILE}							    </c:if>															</td>							<th>결제금액</th>							<td class="price2" id="payPrice">								<fmt:formatNumber var="payment_price" value="${vo.PAYMENT_PRICE}" pattern="#,###.##"/>								${payment_price} 원							</td>						</tr>						<tr>							<th>상품유형</th>							<td>${vo.ORDER_NM }</td>							<th>취소일</th>							<td>${vo.CANCEL_DATE }</td>						</tr>					</tbody>				</table>			</div>			<div class="tb_type5 mb20">				<table>					<thead>						<tr>							<th width="10%">카테고리</th>							<th width="30%">상품명</th>							<th >방문인원</th>							<th width="10%">수량</th>							<th >가격</th>						</tr>					</thead>					<tbody>						<%-- 워터파크 시작 --%>						<c:if test="${not empty vo.WATER_ITEM && vo.WATER_ITEM ne '' && vo.WATER_ADULT_MAN ne '0' && not empty vo.WATER_ADULT_MAN }">							<tr id="water_ad_Man">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit water">${vo.WATER_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.WATER_ADULTS_PRICE }">									<fmt:formatNumber var="water_adults_price" value="${vo.WATER_ADULTS_PRICE}" pattern="#,###.##"/>									성인남자(${water_adults_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.WATER_ADULT_MAN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.WATER_ADULTS_PRICE * vo.WATER_ADULT_MAN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.WATER_ITEM && vo.WATER_ITEM ne '' && vo.WATER_ADULT_WOMEN ne '0' && not empty vo.WATER_ADULT_WOMEN }">							<tr id="water_ad_Women">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit water">${vo.WATER_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.WATER_ADULTS_PRICE }">									<fmt:formatNumber var="water_adults_price" value="${vo.WATER_ADULTS_PRICE}" pattern="#,###.##"/>									성인여자(${water_adults_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.WATER_ADULT_WOMEN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.WATER_ADULTS_PRICE * vo.WATER_ADULT_WOMEN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.WATER_ITEM && vo.WATER_ITEM ne '' && vo.WATER_CHILD_MAN ne '0' && not empty vo.WATER_CHILD_MAN }">							<tr id="water_ch_Man">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit water">${vo.WATER_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.WATER_CHILD_PRICE }">									<fmt:formatNumber var="water_child_price" value="${vo.WATER_CHILD_PRICE}" pattern="#,###.##"/>									소인남자(${water_child_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.WATER_CHILD_MAN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.WATER_CHILD_PRICE * vo.WATER_CHILD_MAN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.WATER_ITEM && vo.WATER_ITEM ne '' && vo.WATER_CHILD_WOMEN ne '0' && not empty vo.WATER_CHILD_WOMEN }">							<tr id="water_ch_Women">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit water">${vo.WATER_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.WATER_CHILD_PRICE }">									<fmt:formatNumber var="water_child_price" value="${vo.WATER_CHILD_PRICE}" pattern="#,###.##"/>									소인여자(${water_child_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.WATER_CHILD_WOMEN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.WATER_CHILD_PRICE * vo.WATER_CHILD_WOMEN }</span> 원</td>							</tr>						</c:if>						<%-- //워터파크 종료 --%>												<%-- 찜질스파 시작 --%>						<c:if test="${not empty vo.SPA_ITEM && vo.SPA_ITEM ne '' && vo.SPA_ADULT_MAN ne '0' && not empty vo.SPA_ADULT_MAN }">							<tr id="spa_ad_Man">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.SPA_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.SPA_ADULTS_PRICE }">									<fmt:formatNumber var="spa_adults_price" value="${vo.SPA_ADULTS_PRICE}" pattern="#,###.##"/>									성인남자(${spa_adults_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.SPA_ADULT_MAN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.SPA_ADULTS_PRICE * vo.SPA_ADULT_MAN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.SPA_ITEM && vo.SPA_ITEM ne '' && vo.SPA_ADULT_WOMEN ne '0' && not empty vo.SPA_ADULT_WOMEN }">							<tr id="spa_ad_Women">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.SPA_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.SPA_ADULTS_PRICE }">									<fmt:formatNumber var="spa_adults_price" value="${vo.SPA_ADULTS_PRICE}" pattern="#,###.##"/>									성인여자(${spa_adults_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.SPA_ADULT_WOMEN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.SPA_ADULTS_PRICE * vo.SPA_ADULT_WOMEN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.SPA_ITEM && vo.SPA_ITEM ne '' && vo.SPA_CHILD_MAN ne '0' && not empty vo.SPA_CHILD_MAN }">							<tr id="spa_ch_Man">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.SPA_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.SPA_CHILD_PRICE }">									<fmt:formatNumber var="spa_child_price" value="${vo.SPA_CHILD_PRICE}" pattern="#,###.##"/>									소인남자(${spa_child_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.SPA_CHILD_MAN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.SPA_CHILD_PRICE * vo.SPA_CHILD_MAN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.SPA_ITEM && vo.SPA_ITEM ne '' && vo.SPA_CHILD_WOMEN ne '0' && not empty vo.SPA_CHILD_WOMEN }">							<tr id="spa_ch_Women">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.SPA_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.SPA_CHILD_PRICE }">									<fmt:formatNumber var="spa_child_price" value="${vo.SPA_CHILD_PRICE}" pattern="#,###.##"/>									소인여자(${spa_child_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.SPA_CHILD_WOMEN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.SPA_CHILD_PRICE * vo.SPA_CHILD_WOMEN }</span> 원</td>							</tr>						</c:if>						<%-- //찜찔스파 종료 --%>												<%-- 복합상품 시작 --%>						<c:if test="${not empty vo.COMPLEX_ITEM && vo.COMPLEX_ITEM ne '' && vo.COMPLEX_ADULT_MAN ne '0' && not empty vo.COMPLEX_ADULT_MAN }">							<tr id="complex_ad_Man">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.COMPLEX_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.COMPLEX_ADULTS_PRICE }">									<fmt:formatNumber var="complex_adults_price" value="${vo.COMPLEX_ADULTS_PRICE}" pattern="#,###.##"/>									성인남자(${complex_adults_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.COMPLEX_ADULT_MAN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.COMPLEX_ADULTS_PRICE * vo.COMPLEX_ADULT_MAN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.COMPLEX_ITEM && vo.COMPLEX_ITEM ne '' && vo.COMPLEX_ADULT_WOMEN ne '0' && not empty vo.COMPLEX_ADULT_WOMEN }">							<tr id="complex_ad_Women">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.COMPLEX_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.COMPLEX_ADULTS_PRICE }">									<fmt:formatNumber var="complex_adults_price" value="${vo.COMPLEX_ADULTS_PRICE}" pattern="#,###.##"/>									성인여자(${complex_adults_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.COMPLEX_ADULT_WOMEN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.COMPLEX_ADULTS_PRICE * vo.COMPLEX_ADULT_WOMEN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.COMPLEX_ITEM && vo.COMPLEX_ITEM ne '' && vo.COMPLEX_CHILD_MAN ne '0' && not empty vo.COMPLEX_CHILD_MAN }">							<tr id="complex_ch_Man">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.COMPLEX_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.COMPLEX_CHILD_PRICE }">									<fmt:formatNumber var="complex_child_price" value="${vo.COMPLEX_CHILD_PRICE}" pattern="#,###.##"/>									소인남자(${complex_child_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.COMPLEX_CHILD_MAN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.COMPLEX_CHILD_PRICE * vo.COMPLEX_CHILD_MAN }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.COMPLEX_ITEM && vo.COMPLEX_ITEM ne '' && vo.COMPLEX_CHILD_WOMEN ne '0' && not empty vo.COMPLEX_CHILD_WOMEN }">							<tr id="complex_ch_Women">								<td class="nomal"><!-- 일반상품 -->&nbsp;</td>								<td class="tit spa">${vo.COMPLEX_ITEM_NM}&nbsp;</td>								<td>									<input type="hidden" name="" class="prdPrice" value="${vo.COMPLEX_CHILD_PRICE }">									<fmt:formatNumber var="complex_child_price" value="${vo.COMPLEX_CHILD_PRICE}" pattern="#,###.##"/>									소인여자(${complex_child_price }원)								</td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.COMPLEX_CHILD_WOMEN }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.COMPLEX_CHILD_PRICE * vo.COMPLEX_CHILD_WOMEN }</span> 원</td>							</tr>						</c:if>						<%-- //복합상품 종료 --%>																		<%-- 대여상품 시작 --%>						<c:if test="${not empty vo.RENTAL1_ITEM && vo.RENTAL1_ITEM ne '' }">							<tr id="rental01">								<td class="rental"><!-- 대여상품 -->&nbsp;</td>								<td class="tit">${vo.RENTAL1_ITEM_NM }</td>								<td><input type="hidden" name="" class="prdPrice" value="${vo.RENTAL1_PRICE }"></td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.RENTAL1_CNT }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.RENTAL1_PRICE * vo.RENTAL1_CNT }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.RENTAL2_ITEM && vo.RENTAL2_ITEM ne '' }">							<tr id="rental02">								<td class="rental"><!-- 대여상품 -->&nbsp;</td>								<td class="tit">${vo.RENTAL2_ITEM_NM }</td>								<td><input type="hidden" name="" class="prdPrice" value="${vo.RENTAL2_PRICE }"></td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.RENTAL2_CNT }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.RENTAL2_PRICE * vo.RENTAL2_CNT }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.RENTAL3_ITEM && vo.RENTAL3_ITEM ne '' }">							<tr id="rental03">								<td class="rental"><!-- 대여상품 -->&nbsp;</td>								<td class="tit rental03">${vo.RENTAL3_ITEM_NM }</td>								<td><input type="hidden" name="" class="prdPrice" value="${vo.RENTAL3_PRICE }"></td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.RENTAL3_CNT }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.RENTAL3_PRICE * vo.RENTAL3_CNT }</span> 원</td>							</tr>						</c:if>						<%-- //대여상품 종료 --%>												<%-- 이벤트상품 시작 --%>						<c:if test="${not empty vo.EVENT1_ITEM && vo.EVENT1_ITEM ne '' }">							<tr id="event01">								<td class="event"><!-- 이벤트상품 -->&nbsp;</td>								<td class="tit">${vo.EVENT1_ITEM_NM }</td>								<td><input type="hidden" name="" class="prdPrice" value="${vo.EVENT1_PRICE }"></td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.EVENT1_CNT }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<%-- <td class="price"><span class="t_prdPrice">${vo.EVENT1_PRICE * vo.EVENT1_CNT }</span> 원</td> --%>								<td class="price"><span class="t_prdPrice">${vo.EVENT1_PRICE * vo.EVENT1_CNT }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.EVENT2_ITEM && vo.EVENT2_ITEM ne '' }">							<tr id="event02">								<td class="event"><!-- 이벤트상품 -->&nbsp;</td>								<td class="tit">${vo.EVENT2_ITEM_NM }</td>								<td><input type="hidden" name="" class="prdPrice" value="${vo.EVENT2_PRICE }"></td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.EVENT2_CNT }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.EVENT2_PRICE * vo.EVENT2_CNT }</span> 원</td>							</tr>						</c:if>						<c:if test="${not empty vo.EVENT3_ITEM && vo.EVENT3_ITEM ne '' }">							<tr id="event03">								<td class="event"><!-- 이벤트상품 -->&nbsp;</td>								<td class="tit event03">${vo.EVENT3_ITEM_NM }</td>								<td><input type="hidden" name="" class="prdPrice" value="${vo.EVENT3_PRICE }"></td>								<td>									<select name="" id="" class="customized-select w60 qty">										<c:forEach begin="0" end="${vo.EVENT3_CNT }" varStatus="num">											<option value="${num.index }" <c:if test="${num.last }">selected="selected"</c:if>>${num.index }</option>										</c:forEach>									</select>								</td>								<td class="price"><span class="t_prdPrice">${vo.EVENT3_PRICE * vo.EVENT3_CNT }</span> 원</td>							</tr>						</c:if>						<%-- //이벤트상품 종료 --%>					</tbody>					<tfoot>						<tr>							<th colspan="4">결제금액</td>							<td class="price"><span class="total t_prdPrice">${vo.PAYMENT_PRICE}</span> 원</td>						</tr>					</tfoot>				</table>			</div>			<div class="tb_type5" id="refund">				<table>					<colgroup>						<col width="20%">						<col>					</colgroup>					<thead>						<tr>							<th colspan="2" align="left">- 환불금액 확인</th>						</tr>					</thead>					<tbody>						<tr>							<td>취소상품 주문금액</td>							<td class="price"><span class="t_cancel">0</span> 원</td>						</tr>						<tr>							<td>위약금</td>							<td class="price">								<c:if test="${vo.RESERVE_STATE eq 'ING'}">								<button class="btn_pack btn_mo d_gray small cancelRemove">제거</button>								</c:if>								<span class="penalty" id="penaltyPrice">0</span> 원							</td>						</tr>						<tr>							<td>최종 환불금액</td>							<td class="price"><span class="totalRefund" id="totalRePrice">0</span> 원</td>						</tr>					</tbody>				</table>			</div>			<c:if test="${vo.RESERVE_STATE eq 'ING'}">			<div class="btns_area bottom right">				<button type="button" class="btn_pack btn_mo d_gray refunds" onclick="">환불</button>			</div>			</c:if>			<c:if test="${vo.RESERVE_STATE eq 'FCANCEL'}">						<div class="tb_type5" id="panalty">				<table>					<colgroup>						<col width="20%">						<col>					</colgroup>					<thead>						<tr>							<th colspan="2" align="left">- 위약금액 확인</th>						</tr>					</thead>					<tbody>						<tr>							<td>위약금</td>							<td class="price">								<span class="panalty">${vo.PANALTY_PRICE}</span> 원							</td>						</tr>					</tbody>				</table>			</div>			<div class="btns_area bottom right">				<button type="button" class="btn_pack btn_mo d_gray panaltyBtn" onclick="">위약금환불</button>			</div>			</c:if>						</form>		</div>	</div></section><form name="cancelForm" id="cancelForm" method="post" onsubmit="return false;">	<input type="hidden" name="authty" value="${pgResultInfo.authty}">	<input type="hidden" name="storeid" value="${pgResultInfo.pgStore}">	<input type="hidden" name="canc_type" value="0">	<input type="hidden" name=trno value="${pgResultInfo.TR_NO}">	<input type="hidden" name="canc_amt" value="0">	<input type="hidden" name="penalty_amt" value="0">		<input type="hidden" name="uid" value="${vo.RESERVE_UID}">		<input type="hidden" name="userName" value="${vo.PAYMENT_NM}">	<input type="hidden" name="email" value="${vo.MEM_ID}">	<input type="hidden" name=goodName value="${vo.ORDER_NM}">	<input type="hidden" name="phoneNo" value="${vo.MEM_MOBILE}">	<input type="hidden" name="reserveday" value="${vo.RESERVE_DATE}">	<input type="hidden" name="ordernum" value="${vo.ORDER_NUM}">	<input type="hidden" name="canc_seq" value="${vo.CANCEL_SEQ}">	<input type="hidden" name="spa_ad_Man" value="${vo.SPA_ADULT_MAN }">	<input type="hidden" name="spa_ad_Women" value="${vo.SPA_ADULT_WOMEN }">	<input type="hidden" name="spa_ch_Man" value="${vo.SPA_CHILD_MAN }">	<input type="hidden" name="spa_ch_Women" value="${vo.SPA_CHILD_WOMEN }">		<input type="hidden" name="water_ad_Man" value="${vo.WATER_ADULT_MAN }">	<input type="hidden" name="water_ad_Women" value="${vo.WATER_ADULT_WOMEN }">	<input type="hidden" name="water_ch_Man" value="${vo.WATER_CHILD_MAN }">	<input type="hidden" name="water_ch_Women" value="${vo.WATER_CHILD_WOMEN }">	<input type="hidden" name="complex_ad_Man" value="${vo.COMPLEX_ADULT_MAN }">	<input type="hidden" name="complex_ad_Women" value="${vo.COMPLEX_ADULT_WOMEN }">	<input type="hidden" name="complex_ch_Man" value="${vo.COMPLEX_CHILD_MAN }">	<input type="hidden" name="complex_ch_Women" value="${vo.COMPLEX_CHILD_WOMEN }">		<input type="hidden" name="rental01" value="${vo.RENTAL1_CNT }">	<input type="hidden" name="rental02" value="${vo.RENTAL2_CNT }">	<input type="hidden" name="rental03" value="${vo.RENTAL3_CNT }">	<input type="hidden" name="event01" value="${vo.EVENT1_CNT }">	<input type="hidden" name="event02" value="${vo.EVENT2_CNT }">	<input type="hidden" name="event03" value="${vo.EVENT3_CNT }">	<input type="hidden" name="sumVisitCnt" value="${vo.ADULT_SUM + vo.CHILD_SUM}">		<input type="hidden" name="reserve_state" value="CANCEL">			<input type="hidden" name="pointNm" value="${vo.POINT_NM}">	<input type="hidden" name="pointCode" value="${vo.POINT_CODE}">									</form><script type="text/javascript">// 아래 전체 데이터 핸들링부분$( document ).ready(function() {	// 표 카테고리 자동입력    var $nomal = $(".nomal");    var $rental = $(".rental");    var $event = $(".event");   	var $water = $(".water");   	var $spa = $(".spa");	var $complex = $(".complex");    var cata_code = "${vo.ORDER_TP}";        if($nomal.length != 0 && cata_code == "0" ){   	$nomal.eq(0).text("입장상품"); 	   }	if($nomal.length != 0 && cata_code == "1" ){		$nomal.eq(0).text("패키지"); 		}    if($rental.length != 0){	$rental.eq(0).text("대여상품"); 	}    if($event.length != 0){		$event.eq(0).text("이벤트상품");	}//    if($spa.length != 0){		$spa.eq(0).text("찜질스파");		}//    if($water.length != 0){		$water.eq(0).text("워터파크");		}     //가격 콤파 추가	$(".t_prdPrice").each(function(){		$(this).text($(this).text().replace(/\B(?=(\d{3})+(?!\d))/g, ","));	});   });function chkAll(me){	if($(me).hasClass('chkAll')){		if($(me).prop("checked") == false){	    	$(me).closest("form").find("input[type='checkbox']").prop("checked", false).closest("span").removeClass('on');	    	$(me).closest("form").find("input[type='radio']#customer_info_on").prop("checked", false).closest("span").removeClass('on');	    	$(me).closest("form").find("input[type='radio']#customer_info_off").prop("checked", true).closest("span").addClass('on');	    }else{	    	$(me).closest("form").find("input[type='checkbox']").prop("checked", true).closest("span").addClass('on');	    	$(me).closest("form").find("input[type='radio']#customer_info_on").prop("checked", true).closest("span").addClass('on');	    	$(me).closest("form").find("input[type='radio']#customer_info_off").prop("checked", false).closest("span").removeClass('on');	    }	}else{	}		}// 환불금액확인 체인지function refundPrice(c, p){	var cancelPrice = parseInt($('#refund').find('.t_cancel').text().replace(/\,/g,'')),		penalty = parseInt($('#refund').find('.penalty').text().replace(/\,/g,'')),		totalRefund = 0,		refund_cancelPrice = cancelPrice + c,		refund_penalty = penalty + p;	// 당일 취소 일 경우만 위약금 발생	var reserve_date1 = "${reserve_date1}"*1;	var today = "${today}"*1;		if(refund_penalty > 0){ refund_penalty = 0; }	$('#refund').find('.t_cancel').text(priceCommas(refund_cancelPrice));	if(reserve_date1 <= today){		//당일 취소일때만 위약금 적용		$('#refund').find('.penalty').text(priceCommas(refund_penalty));	}else{		// 당일 이전이면 위약금 0		refund_penalty = 0;	}	$('#refund').find('.totalRefund').text(priceCommas(refund_cancelPrice+refund_penalty));}// 셀렉트 변경에 의한 가격 변경 이벤트$(".qty").change(function(e) {	<c:if test="${vo.RESERVE_STATE eq 'ING'}">		var prdPrice = $(this).closest('tr').find('.prdPrice').val(),		qty = $(this).val(),		totalPrice = prdPrice * qty,		cancelPrice = parseInt($(this).closest('tr').find('.t_prdPrice').text().replace(/\,/g,'')) - totalPrice,		penalty = -cancelPrice * 0.1,		total = 0;	$(this).closest('tr').find('.t_prdPrice').text(priceCommas(totalPrice));	$(".t_prdPrice").each(function(i, el) {		total += parseInt($(this).text().replace(/\,/g,''));	});	/* $('.total').text(priceCommas(total)); */	refundPrice(cancelPrice, penalty);	var nameoftype = $(this).closest('tr').attr('id');		cntSet(qty, nameoftype);	</c:if>});//방문인원 및 렌탈/ 이벤트 수량 변경 관련function cntSet(qty,type){	$("input[name='"+type+"']").val(qty);};// 위약금 제거 버튼$(".cancelRemove").click(function(e) {	e.preventDefault();	$('.penalty').text(0);	$('#refund').find('.totalRefund').text($('#refund').find('.t_cancel').text());});// 환불 버튼$(".refunds").click(function(e) {	e.preventDefault();	var amount = parseInt($("#totalRePrice").text().replace(',',''));	var payment = parseInt($("#payPrice").text().replace(',',''));	var penalty = parseInt($("#penaltyPrice").text().replace(',',''));		if(amount != 0){		//amount : 최종환불금액, payment : 결제금액, penalty : 위약금		if(amount != payment){			$("input[name='canc_type']").val("3");			$("input[name='canc_amt']").val(amount);			$("input[name='penalty_amt']").val(penalty);		} else {			$("input[name='canc_amt']").val(amount);			$("input[name='penalty_amt']").val(0);			$('.penalty').text(0);		}			if($('.penalty').text() != '0'){			$("input[name='reserve_state']").val("FCANCEL");		}				var payType = '${pgResultInfo.authty }';		var goUrl = '';		if(payType === '1010'){			goUrl = '/reserve/card_cancel_admin.af';		}else if(payType === '2010' || payType === '2030'){			goUrl = '/reserve/cash_cancel_admin.af';		}else if(payType === '4110'){			goUrl = '/reserve/ssg_cancel_admin.af';		}					if(confirm("예약내역을 취소하고 결제 금액을 환불합니다. 계속 진행하시겠습니까?")) {	    	var formData = $("#cancelForm").serialize().replace(/%/g,'%25');	    	$.ajax({		   		async: false		   		,type: "post"		   		,url : goUrl		   		,data : formData		   		,dataType : "html"		   		,success: function(obj){					alert(obj);					location.reload();		   		}		   		,error: function(xhr, option, error){		   			alert("에러가 발생했습니다. 잠시 후에 다시하세요.");		   		}	   		});					}	}else{		alert('환불금액을 셋팅해 주시기 바랍니다.');		return;	}});//위약금환불 버튼$(".panaltyBtn").click(function(e) {	e.preventDefault();	var amount = parseInt($("#panalty").find(".panalty").text().replace(',',''));	var payment = parseInt($("#payPrice").text().replace(',',''));		if(amount != payment){		$("input[name='canc_type']").val("3");		$("input[name='canc_amt']").val(amount);	}		$("input[name='reserve_state']").val("PANALTY");			var payType = '${pgResultInfo.authty }';	var goUrl = '';	if(payType === '1010' || payType === '4110'){		goUrl = '/reserve/card_cancel_admin.af';	}else{		goUrl = '/reserve/cash_cancel_admin.af';	}		if(confirm("위약 금액을 환불합니다. 계속 진행하시겠습니까?")) {    	var formData = $("#cancelForm").serialize().replace(/%/g,'%25');    	$.ajax({	   		async: false	   		,type: "post"	   		,url : goUrl	   		,data : formData	   		,dataType : "html"	   		,success: function(obj){				alert(obj);				location.reload();	   		}	   		,error: function(xhr, option, error){	   			alert("에러가 발생했습니다. 잠시 후에 다시하세요.");	   		}   		});				}});</script>